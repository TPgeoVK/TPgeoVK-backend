# Методы API
---

Все методы используют два HTTP-кода ответа: 200 OK в случае успешного выполнения, и 400 Bad Request в случае ошибки.
Базовый URL: *http://tp2017.park.bmstu.cloud/tpgeovk*

## /trigger

### GET /trigger
Метод, запускающий асинхронный сбор данных и рекомендации. На вход принимает параметры:
 - **token** - токен пользователя
 - **latitude** - широта
 - **longitude** - долгота
От полученных данных будет зависеть результат обращения к следующим методам:
 - **/recommend/friends**
 - **/recommend/groups**
 - **/recommend/places/nearest**
 - **/location/detectPlace**
Повторный запрос запустит новый сбор данных, если предыдущий запрос завершился (успешно или с ошибкой).

### GET /trigger/status
Возвращает объект статуса сбора данных и рекомендаций для пользователя. На вход принимает параметры:
 - **token** - токен пользователя

Метод возвращает:
 - Объект статуса задачи с HTTP-кодом 200 ОК в случае успеха
 - Объект ошибки с HTTP-кодом 401 Bad Request в случае отсутствия задачи или ошибки

## /location

### POST /location/detectPlace
Возвращает наиболее вероятное место, в котором находится пользователь в зависимости от координат и текста поста. Принимает на вход объект запроса определения места. Возвращает:
 - Объект места с HTTP-кодом 200 OK  в случае успеха
 - Объект ошибки с HTTP-кодом 401 Bad Request в случае ошибки
Метод асинхронный, т.е. зависит от выполнения метода /trigger.

## /recommend

### GET /recommend/places/nearest
Рекомендует ближайшие места на основе предпочтений и истории чекинов пользователя. На вход принимает параметры:
 - **token** - токен пользователя

Метод возвращает:
 - Список полных объектов мест с HTTP-кодом 200 OK  в случае успеха
 - Объект ошибки с HTTP-кодом 401 Bad Request в случае ошибки
Метод асинхронный, т.е. зависит от выполнения метода /trigger.


### GET /recommend/friends
Рекомендует пользователей в зависимости от предпочтений и истории чекинов пользователя. На вход принимает параметры:
 - **token** - токен пользователя

Метод возвращает:
 - Список объектов пользователей с HTTP-кодом 200 OK  в случае успеха
 - Объект ошибки с HTTP-кодом 401 Bad Request в случае ошибки
Метод асинхронный, т.е. зависит от выполнения метода /trigger.


### GET /recommend/groups
Рекомендует группы в зависимости от предпочтений и истории чекинов пользователя. На вход принимает параметры:
 - **token** - токен пользователя

Метод возвращает:
 - Список объектов групп с HTTP-кодом 200 OK  в случае успеха
 - Объект ошибки с HTTP-кодом 401 Bad Request в случае ошибки
Метод асинхронный, т.е. зависит от выполнения метода /trigger.

### GET /recommend/event/byFriends (не рекомендуется использовать)
Рекомендует мероприятия в зависимости от координат и друзей пользователя. На вход принимает параметры:
 - **token** - токен пользователя
 - **latitude** - широта
 - **longitude** - долгота

Метод возвращает:
 - Список объектов групп с HTTP-кодом 200 OK  в случае успеха
 - Объект ошибки с HTTP-кодом 401 Bad Request в случае ошибки

## /vkapi

### GET /vkapi/user
Получает информацию о текущем пользователе. На вход принимает параметры:
 - **token** - токен пользователя

Метод возвращает:
 - Объект пользователя с HTTP-кодом 200 OK  в случае успеха
 - Объект ошибки с HTTP-кодом 401 Bad Request в случае ошибки

### GET /vkapi/checkins/all
Получает все чекины пользователя. На вход принимает параметры:
 - **token** - токен пользователя

Метод возвращает:
 - Список объектов чекинов с HTTP-кодом 200 OK  в случае успеха
 - Объект ошибки с HTTP-кодом 401 Bad Request в случае ошибки

### GET /vkapi/checkins/latest
Получает все чекины за последние 5 минут в окрестности заданной точки. На вход принимает параметры:
 - **token** - токен пользователя
 - **latitude** - широта
 - **longitude** - долгота

Метод возвращает:
 - Список объектов чекинов с HTTP-кодом 200 OK  в случае успеха
 - Объект ошибки с HTTP-кодом 401 Bad Request в случае ошибки


### POST /vkapi/post/create
Создает новый чекин на стене пользователя. На вход принимает объект запроса на создание чекина.

Метод возвращает:
 - Объект созданного чекина с HTTP-кодом 200 OK  в случае успеха
 - Объект ошибки с HTTP-кодом 401 Bad Request в случае ошибки
